{"version":3,"sources":["main.js"],"names":["canvas","fabric","Canvas","preserveObjectStacking","Image","fromURL","oImg","scale","insertAt","text","Text","top","left","set","cornerSize","padding","transparentCorners","cornerStyle","cornerColor","borderColor","$","listener","window","keypress","Listener","simple_combo","obj","getActiveObject","remove","bringForward","sendBackwards","_textInit","btns","document","getElementsByClassName","btnDownload","btnAdjust","$theText","onclick","downloadImg","on","newText","val","length","type","renderAll","download","toDataURL","getObjects","each","index","item","prop"],"mappings":"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","file":"main.acbc3743.map","sourceRoot":"..","sourcesContent":["// create a wrapper around native canvas element (with id=\"c\")\r\nvar canvas = new fabric.Canvas('myImage', {\r\n  preserveObjectStacking: true\r\n});\r\n\r\n// 异步获取图片\r\nfabric.Image.fromURL('3.jpg', function(oImg) {\r\n  // scale image down, and flip it, before adding it onto canvas\r\n  oImg.scale(0.5);\r\n  canvas.insertAt(oImg, 0);\r\n});\r\n\r\nvar text = new fabric.Text('just 怼 it', {\r\n  top: 400,\r\n  left: 200\r\n});\r\ncanvas.insertAt(text, 1);\r\ntext.set({\r\n  cornerSize: 15,\r\n  padding: 15,\r\n  transparentCorners: true,\r\n  cornerStyle: 'circle',\r\n  cornerColor: 'red',\r\n  borderColor: 'red'\r\n});\r\n\r\n$(function () {\r\n  var listener = new window.keypress.Listener();\r\n\r\n  listener.simple_combo('delete', () => {\r\n    var obj = canvas.getActiveObject();\r\n    if (obj) {\r\n      canvas.remove(obj);\r\n    }\r\n  });\r\n\r\n  listener.simple_combo('-', () => {\r\n    var obj = canvas.getActiveObject();\r\n    if (obj) {\r\n      canvas.bringForward(obj);\r\n    }\r\n  });\r\n\r\n  listener.simple_combo('+', () => {\r\n    var obj = canvas.getActiveObject();\r\n    if (obj) {\r\n      canvas.sendBackwards(obj);\r\n    }\r\n  });\r\n\r\n  _textInit();\r\n\r\n});\r\n\r\nvar btns = document.getElementsByClassName('btn-hook');\r\nvar btnDownload = btns[0];\r\nvar btnAdjust = btns[1];\r\nvar $theText = $('#theText');\r\n\r\nbtnDownload.onclick = downloadImg;\r\n// btnAdjust.onclick = adjustImg;\r\n\r\n$theText.on('keyup', () => {\r\n  let newText = $theText.val();\r\n  if (newText.length > 0) {\r\n    var obj = canvas.getActiveObject();\r\n    if (obj && obj.type === 'text') {\r\n      obj.set('text', newText);\r\n      canvas.renderAll();\r\n    }\r\n  }\r\n});\r\n\r\nfunction downloadImg() {\r\n  // console.log(canvas.toDataURL('png'));\r\n  download(canvas.toDataURL('png'), 'fightImg.png', 'image/png');\r\n};\r\n\r\n// function adjustImg() {\r\n//   var obj = canvas.getActiveObject();\r\n//   if (obj.type === 'image') {\r\n//     console.log(\"top = \" + obj.top);\r\n//     console.log(\"left = \" + obj.left);\r\n//     console.log(\"angle = \" + obj.angle);\r\n//     console.log(\"scaleX = \" + obj.scaleX);\r\n//     console.log(\"scaleY = \" + obj.scaleY);\r\n//   }\r\n// };\r\n\r\nfunction _textInit() {\r\n  $(canvas.getObjects()).each((index, item) => {\r\n    if (item.type === 'text') {\r\n      item.on('selected', () => {\r\n        $theText.val(item.text);\r\n        $theText.prop('disabled', false);\r\n      });\r\n      item.on('deselected', () => {\r\n        $theText.val('点击画布中的文字进行修改');\r\n        $theText.prop('disabled', true);\r\n      });\r\n    }\r\n  });\r\n}"]}